<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>究竟什么是shadowDOM | 前端南玖</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/nanjiu/sy.jpg">
    <meta name="description" content="前端南玖的博客">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="referrer" content="no-referrer">
    
    <link rel="preload" href="/nanjiu/assets/css/0.styles.01596ed3.css" as="style"><link rel="preload" href="/nanjiu/assets/js/app.aa12a3a6.js" as="script"><link rel="preload" href="/nanjiu/assets/js/3.21869b4f.js" as="script"><link rel="preload" href="/nanjiu/assets/js/1.9b52f643.js" as="script"><link rel="preload" href="/nanjiu/assets/js/20.5d90702a.js" as="script"><link rel="prefetch" href="/nanjiu/assets/js/10.f1a27924.js"><link rel="prefetch" href="/nanjiu/assets/js/11.3c390943.js"><link rel="prefetch" href="/nanjiu/assets/js/12.f2235a6b.js"><link rel="prefetch" href="/nanjiu/assets/js/13.d13adf12.js"><link rel="prefetch" href="/nanjiu/assets/js/14.ff2ac999.js"><link rel="prefetch" href="/nanjiu/assets/js/15.c06fff87.js"><link rel="prefetch" href="/nanjiu/assets/js/16.ff7aee48.js"><link rel="prefetch" href="/nanjiu/assets/js/17.3a6e593b.js"><link rel="prefetch" href="/nanjiu/assets/js/18.4fcd25f1.js"><link rel="prefetch" href="/nanjiu/assets/js/19.2946e000.js"><link rel="prefetch" href="/nanjiu/assets/js/21.ac02a872.js"><link rel="prefetch" href="/nanjiu/assets/js/22.dc3c16cb.js"><link rel="prefetch" href="/nanjiu/assets/js/23.5b9d6fe7.js"><link rel="prefetch" href="/nanjiu/assets/js/24.862ec791.js"><link rel="prefetch" href="/nanjiu/assets/js/25.21215dcf.js"><link rel="prefetch" href="/nanjiu/assets/js/26.8a9f3742.js"><link rel="prefetch" href="/nanjiu/assets/js/27.dd584b99.js"><link rel="prefetch" href="/nanjiu/assets/js/28.72b8ef91.js"><link rel="prefetch" href="/nanjiu/assets/js/29.112f0e24.js"><link rel="prefetch" href="/nanjiu/assets/js/30.5b873c0b.js"><link rel="prefetch" href="/nanjiu/assets/js/31.cc2cb3c5.js"><link rel="prefetch" href="/nanjiu/assets/js/32.7d0c815a.js"><link rel="prefetch" href="/nanjiu/assets/js/33.621180eb.js"><link rel="prefetch" href="/nanjiu/assets/js/34.fa215925.js"><link rel="prefetch" href="/nanjiu/assets/js/35.9465b9e1.js"><link rel="prefetch" href="/nanjiu/assets/js/36.a1b34b57.js"><link rel="prefetch" href="/nanjiu/assets/js/37.0364a7c2.js"><link rel="prefetch" href="/nanjiu/assets/js/38.afc5ac1f.js"><link rel="prefetch" href="/nanjiu/assets/js/39.5f163a4d.js"><link rel="prefetch" href="/nanjiu/assets/js/4.38958b26.js"><link rel="prefetch" href="/nanjiu/assets/js/40.4ac92165.js"><link rel="prefetch" href="/nanjiu/assets/js/41.6a41eff2.js"><link rel="prefetch" href="/nanjiu/assets/js/42.095e8dbf.js"><link rel="prefetch" href="/nanjiu/assets/js/5.9d762e5c.js"><link rel="prefetch" href="/nanjiu/assets/js/6.ef23ec35.js"><link rel="prefetch" href="/nanjiu/assets/js/7.cc01232d.js"><link rel="prefetch" href="/nanjiu/assets/js/8.7cc91b88.js"><link rel="prefetch" href="/nanjiu/assets/js/9.e2d6a32d.js">
    <link rel="stylesheet" href="/nanjiu/assets/css/0.styles.01596ed3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>前端南玖</h3> <p class="description" data-v-59e6cb88>前端南玖的博客</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2024
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/nanjiu/" class="home-link router-link-active"><img src="/nanjiu/logo.png" alt="前端南玖" class="logo"> <span class="site-name">前端南玖</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/nanjiu/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nanjiu/htmlcss/" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="undefined"></i>
  HTML&amp;CSS
</a></li><li class="dropdown-item"><!----> <a href="/nanjiu/javascript/" class="nav-link"><i class="undefined"></i>
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/nanjiu/miniprogram/" class="nav-link"><i class="undefined"></i>
  小程序
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      工程化
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nanjiu/webpack/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/nanjiu/docker/" class="nav-link"><i class="undefined"></i>
  docker
</a></li><li class="dropdown-item"><!----> <a href="/nanjiu/engineering/" class="nav-link"><i class="undefined"></i>
  合集
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Node
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nanjiu/nest/" class="nav-link"><i class="undefined"></i>
  Nest
</a></li><li class="dropdown-item"><!----> <a href="/nanjiu/npm/" class="nav-link"><i class="undefined"></i>
  Npm
</a></li></ul></div></div><div class="nav-item"><a href="/nanjiu/flutter/" class="nav-link"><i class="undefined"></i>
  Flutter
</a></div><div class="nav-item"><a href="/nanjiu/performance/" class="nav-link"><i class="undefined"></i>
  性能优化
</a></div><div class="nav-item"><a href="/nanjiu/about/" class="nav-link"><i class="undefined"></i>
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="/nanjiu/sy.jpg" alt="author-avatar" class="personal-img" data-v-1fad0c41> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>32</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>14</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41><li class="social-item" data-v-1fad0c41><i class="iconfont reco-github" style="color:#f8b26a;" data-v-1fad0c41></i></li><li class="social-item" data-v-1fad0c41><i class="iconfont reco-juejin" style="color:#67cc86;" data-v-1fad0c41></i></li><li class="social-item" data-v-1fad0c41><i class="iconfont reco-zhihu" style="color:#f47e60;" data-v-1fad0c41></i></li></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/nanjiu/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nanjiu/htmlcss/" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="undefined"></i>
  HTML&amp;CSS
</a></li><li class="dropdown-item"><!----> <a href="/nanjiu/javascript/" class="nav-link"><i class="undefined"></i>
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/nanjiu/miniprogram/" class="nav-link"><i class="undefined"></i>
  小程序
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      工程化
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nanjiu/webpack/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/nanjiu/docker/" class="nav-link"><i class="undefined"></i>
  docker
</a></li><li class="dropdown-item"><!----> <a href="/nanjiu/engineering/" class="nav-link"><i class="undefined"></i>
  合集
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Node
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nanjiu/nest/" class="nav-link"><i class="undefined"></i>
  Nest
</a></li><li class="dropdown-item"><!----> <a href="/nanjiu/npm/" class="nav-link"><i class="undefined"></i>
  Npm
</a></li></ul></div></div><div class="nav-item"><a href="/nanjiu/flutter/" class="nav-link"><i class="undefined"></i>
  Flutter
</a></div><div class="nav-item"><a href="/nanjiu/performance/" class="nav-link"><i class="undefined"></i>
  性能优化
</a></div><div class="nav-item"><a href="/nanjiu/about/" class="nav-link"><i class="undefined"></i>
  关于
</a></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>HTML</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nanjiu/htmlcss/" aria-current="page" class="active sidebar-link">究竟什么是shadowDOM</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nanjiu/htmlcss/1.html" class="sidebar-link">两行CSS让页面提升了近7倍渲染性能！</a></li><li><a href="/nanjiu/htmlcss/2.html" class="sidebar-link">使用clip-path将 GIF 绘制成跳动的字母</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>究竟什么是shadowDOM</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2024
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">究竟什么是shadowDOM</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>南玖</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2023/6/21</span></i> <i class="iconfont reco-eye" data-v-8a445198><span id="/nanjiu/htmlcss/" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-8a445198><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>html</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="shadow-dom-是什么"><a href="#shadow-dom-是什么" class="header-anchor">#</a> shadow dom 是什么？</h2> <p>顾名思义，shadow dom直译的话就是影子dom，但我更愿把它理解为DOM中的DOM。因为他能够为Web组件中的 DOM和 CSS提供了封装，实际上是在浏览器渲染文档的时候会给指定的DOM结构插入编写好的DOM元素，但是插入的Shadow DOM 会与主文档的DOM保持分离，也就是说Shadow DOM不存在于主DOM树上。</p> <p>并且<strong>Shadow DOM封装出来的DOM元素是独立的，外部的配置不会影响到内部，内部的配置也不会影响外部。</strong></p> <p><strong>如果这篇文章有帮助到你，❤️关注+点赞❤️鼓励一下作者，文章公众号首发，关注 <code>前端南玖</code> 第一时间获取最新文章～</strong></p> <h3 id="思考"><a href="#思考" class="header-anchor">#</a> 思考</h3> <p>理解完它的概念，我们再来思考一个问题：</p> <p><strong>为什么我们用的一些标签明明就是一个空元素，但他却能够渲染出各种复杂的场景？</strong></p> <ul><li>input</li> <li>video</li> <li>audio</li> <li>textarea</li> <li>等...</li></ul> <p>可能很多同学都没想过为什么这些标签跟我们常用的<code>div</code>标签不一样，它们就简单写个标签就能渲染出对应的样式与功能；</p> <p>或者有些同学理解成这都是底层渲染的事，我们不必关心。</p> <p align="center"><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/083d840114304adaa9da9d2e5e3c2ea1~tplv-k3u1fbpfcp-watermark.image?" alt="ydl.gif"></p> <p>是的，这些标签内部的内容确实都是底层渲染的，不过我们也不是看不到它们内部的实现原理。</p> <h3 id="查看html原生标签的shadow-dom"><a href="#查看html原生标签的shadow-dom" class="header-anchor">#</a> 查看html原生标签的Shadow DOM</h3> <p>在html中写入以下标签，然后到浏览器控制台去查看</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>range<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">controls</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8160407690e84b14a7b9ee02f063867a~tplv-k3u1fbpfcp-watermark.image?" alt="1.png"></p> <p>很多人看到的是这样的，但这和我们写的没有任何区别呀？别急，这就带你看看他们的真实面目～</p> <p><strong>首先打开浏览器控制台的设置选项</strong></p> <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/34e9cec3f4364048a7e783a33a8160bd~tplv-k3u1fbpfcp-watermark.image?" alt="2.png"></p> <p><strong>然后再找到Preference -&gt; Elements，把show user anent shadow dom勾上</strong></p> <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/00e7b489a71141e4adba0fbec9dc7d3c~tplv-k3u1fbpfcp-watermark.image?" alt="3.png"></p> <p>这时候我们再来看一下此时的dom元素发生了什么变化</p> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8149a1a84a8a4b64a1732bc2409eea8e~tplv-k3u1fbpfcp-watermark.image?" alt="4.png"></p> <p>我们会发现这些标签内部都大有乾坤，在这些标签下面都多了一个<strong>shadow root</strong>，在它里面才是这些标签的真实布局。</p> <p>既然这些标签内部都有一些子元素布局，那么我们能不能通过JavaScript来访问到它们呢？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span>firstChild<span class="token punctuation">)</span>  <span class="token comment">// null</span>
</code></pre></div><p>很明显，这是不可以的！</p> <p>因为它为web开发者设定了一个边界，界定了哪些是你可以访问的，哪些实现细节是访问不到的。然而，浏览器本身却可以随意跨越这个边界。设置这样一个边界之后，它们就可以在你看不见的地方使用熟悉的web技术、同样的HTML元素去创建更多的功能，而不是像你一样要在页面上用div和span来堆。</p> <h2 id="shadow-dom-结构"><a href="#shadow-dom-结构" class="header-anchor">#</a> shadow dom 结构</h2> <p><strong>Shadow DOM</strong> 允许将隐藏的 DOM 树附加到常规的 DOM 树中——它以 <code>shadow root</code> 节点为起始根节点，在这个根节点的下方，可以是任意元素，和普通的 DOM 元素一样。</p> <p>就是因为这个特点所以我们才能看到上面那些单个空标签就能够渲染出各种各样的复杂场景。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fc0be53adcdf455ba6d09e47fd380f9f~tplv-k3u1fbpfcp-watermark.image?" alt="shadowdom.png"></p> <p>上面这张图非常直观的表现了<code>shadow dom</code>的结构以及它与真实<code>dom</code>的关系。</p> <h3 id="shadow-host"><a href="#shadow-host" class="header-anchor">#</a> shadow host</h3> <p>一个常规 DOM 节点，Shadow DOM 会被附加到这个节点上。</p> <h3 id="shadow-bounday"><a href="#shadow-bounday" class="header-anchor">#</a> shadow bounday</h3> <p>Shadow DOM 结束的地方，也是常规 DOM 开始的地方。</p> <h3 id="shadow-tree"><a href="#shadow-tree" class="header-anchor">#</a> shadow tree</h3> <p>Shadow DOM 内部的 DOM 树。</p> <h3 id="shadow-root"><a href="#shadow-root" class="header-anchor">#</a> shadow root</h3> <p>Shadow tree 的根节点。</p> <h2 id="如何使用shadow-dom"><a href="#如何使用shadow-dom" class="header-anchor">#</a> 如何使用shadow dom？</h2> <h3 id="创建一个shadow-dom"><a href="#创建一个shadow-dom" class="header-anchor">#</a> 创建一个shadow dom</h3> <p>我们可以使用<code>attachShadow</code>给指定元素挂载一个<code>shadow dom</code>，并且返回对shadow root的引用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> shadowroot <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'open'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  &lt;div&gt;前端南玖&lt;/div&gt;
 </span><span class="token template-punctuation string">`</span></span>
shadowroot<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> template
</code></pre></div><h3 id="shadow-dom-mode"><a href="#shadow-dom-mode" class="header-anchor">#</a> shadow dom mode</h3> <p>当调用<code>Element.attachShadow()</code>方法t时，必须通过传递一个对象作为参数来指定shadow DOM树的封装模式，否则将会抛出一个<code>TypeError</code>。该对象必须具有<code>mode</code>属性，值为 <code>open</code> 或 <code>closed</code>。</p> <ul><li><code>open</code> shadow root 元素可以从 js 外部访问根节点，例如使用 <code>Element.shadowRoot</code>:</li></ul> <div class="language- extra-class"><pre class="language-text"><code>element.shadowRoot; // 返回一个 ShadowRoot 对象
</code></pre></div><ul><li><code>closed</code> 拒绝从 js 外部访问关闭的 shadow root 节点</li></ul> <div class="language- extra-class"><pre class="language-text"><code>element.shadowRoot; // 返回 null
</code></pre></div><p><strong>浏览器通常用关闭的 shadow roo 来使某些元素的实现内部不可访问，而且不可从JavaScript更改。</strong></p> <p>对于一些不希望公开shadow root 的Web组件来说，封闭的shadow DOM看起来非常方便，然而在实践中绕过封闭的shadow DOM并不难。但是完全隐藏shadow DOM所需的工作量也大大超过了它的价值。</p> <h2 id="哪些元素可以挂载shadow-dom"><a href="#哪些元素可以挂载shadow-dom" class="header-anchor">#</a> 哪些元素可以挂载shadow dom?</h2> <p>这里需要注意的是并非所有html元素都可以挂载<code>shadow dom</code>，只有以下这些元素可以充当<code>shadow dom</code>的 shadow host</p> <table><thead><tr><th>article</th> <th>aside</th> <th>blockquote</th> <th>body</th></tr></thead> <tbody><tr><td><strong>div</strong></td> <td><strong>footer</strong></td> <td><strong>h1</strong></td> <td><strong>h2</strong></td></tr> <tr><td><strong>h3</strong></td> <td><strong>h4</strong></td> <td><strong>h5</strong></td> <td><strong>h6</strong></td></tr> <tr><td><strong>header</strong></td> <td><strong>main</strong></td> <td><strong>nav</strong></td> <td><strong>p</strong></td></tr> <tr><td><strong>section</strong></td> <td><strong>span</strong></td> <td>任何带有有效的名称且可独立存在的自定义元素</td> <td></td></tr></tbody></table> <p>当我们尝试在其它元素挂在shadow dom时，浏览器则会抛出异常。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> inputRoot <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'open'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee389f0284244705a179b4587df49e8b~tplv-k3u1fbpfcp-watermark.image?" alt="5.png"></p> <h2 id="shadow-dom的特点"><a href="#shadow-dom的特点" class="header-anchor">#</a> shadow dom的特点</h2> <p>从前面的介绍，我们知道shadow dom是游离在 DOM 树之外的节点树，但是它是基于普通 DOM 元素（非 document）创建的，并且创建后的 Shadow-dom 节点可以从界面上直观的看到。<strong>最重要的一点是Shadow-dom 具有良好的密封性。</strong></p> <h3 id="样式"><a href="#样式" class="header-anchor">#</a> 样式</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.wx_name</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span>aqua<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wx_name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>我是真实dom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">const</span> shadowroot <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'open'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
            &lt;div class=&quot;wx_name&quot;&gt;shadow dom - 前端南玖&lt;/div&gt;
        </span><span class="token template-punctuation string">`</span></span>
        shadowroot<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> template
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>它渲染出来是下面这样的👇：</p> <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/455e250c809848478c10ade537de7810~tplv-k3u1fbpfcp-watermark.image?" alt="6.png"></p> <p>上面我们说了shadow dom是游离在 DOM 树之外的节点树，所以我们文档上的CSS就不会作用在他身上。</p> <h3 id="样式化host元素"><a href="#样式化host元素" class="header-anchor">#</a> 样式化host元素</h3> <p><code>host</code>伪类选择器允许你从shadow root中的任何地方访问shadow host</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> shadowroot <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'open'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
       &lt;div class=&quot;wx_name&quot;&gt;shadow dom - 前端南玖&lt;/div&gt;
       &lt;style&gt;
          :host {
             border: 1px solid #ccc;
             color: pink;
           }
        &lt;/style&gt;
</span><span class="token template-punctuation string">`</span></span>
shadowroot<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> template
</code></pre></div><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/56019ed64fdb4d5c913dea09a6bb98a3~tplv-k3u1fbpfcp-watermark.image?" alt="7.png"></p> <p>需要注意的是<code>:host</code>仅在shadow root中有效，并且在shadow root之外定义的样式规则比<code>:host</code>中定义的规则具有更高的特殊性。</p> <h3 id="样式钩子"><a href="#样式钩子" class="header-anchor">#</a> 样式钩子</h3> <p>shadow dom还有一个非常重要的一个特点就是可以使用<code>CSS自定义属性</code>来创建样式占位符，并允许用户填充。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">#root</span> <span class="token punctuation">{</span>
    <span class="token property">--bg</span><span class="token punctuation">:</span> coral<span class="token punctuation">;</span>
    <span class="token property">--color</span><span class="token punctuation">:</span> #<span class="token property">fff</span><span class="token punctuation">:</span> 
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">

  <span class="token keyword">const</span> shadowroot <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'open'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      &lt;div class=&quot;wx_name&quot;&gt;shadow dom - 前端南玖&lt;/div&gt;
      &lt;style&gt;
          .wx_name {
              background: var(--bg, red);
              color: var(--color, #000)
          }
  &lt;/style&gt;
</span><span class="token template-punctuation string">`</span></span>
  shadowroot<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> template
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7d6ab6c00156404f96c58b2481484f63~tplv-k3u1fbpfcp-watermark.image?" alt="8.png"></p> <h3 id="通过css访问shadow"><a href="#通过css访问shadow" class="header-anchor">#</a> 通过CSS访问shadow</h3> <p>如果我们想要自定义一些原生标签的样式应该怎样做呢，很显然常规的CSS选择器并不能获取到shadow dom内部元素。那我们就一点办法没有了吗？其实这里我们可以通过一些伪元素来实现，比如：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>range<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>它默认长这样</p> <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b4f49ef58c1e4cb89e5d8f30accb8b88~tplv-k3u1fbpfcp-watermark.image?" alt="9.png"></p> <p>那我们怎么去改变他的样式呢，比如给它换种背景色</p> <p>直接给input写背景色能实现吗？</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">input</span><span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #ccc<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>很显然这是一种大聪明行为，那它就这一个元素，究竟怎样才能改变它的背景色呢，上面我们不是说了吗，它内部是有shadow dom的</p> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ef21279ce84748afac22dab145d8c0d9~tplv-k3u1fbpfcp-watermark.image?" alt="10.png"></p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">input[type=range]::-webkit-slider-runnable-track</span> <span class="token punctuation">{</span>
  <span class="token property">-webkit-appearance</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> chocolate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们可以通过伪元素来访问到shadow的内部元素并改变其样式。</p> <h3 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h3> <p>在shadow DOM内触发的事件可以穿过shadow边界并冒泡到light DOM；但是<code>Event.target</code>的值会自动更改，因此它看起来好像该事件源自其包含的shadow树而不是实际元素的host元素。</p> <p>此更改称为事件重定向，其背后的原因是保留shadow DOM封装。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">const</span> shadowroot <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'open'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
            &lt;div class=&quot;wx_name&quot;&gt;shadow dom - aaa&lt;/div&gt;
            &lt;div class=&quot;wx_name&quot;&gt;shadow dom - bbb&lt;/div&gt;
            &lt;div class=&quot;wx_name&quot;&gt;shadow dom - ccc&lt;/div&gt;
        </span><span class="token template-punctuation string">`</span></span>
  shadowroot<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> template
  document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>当点击shadow dom中的任何元素时，打印出来的都是<code>root</code>，监听器无法看到调度该事件的真实元素。</p> <h2 id="自定义元素托管shadow-dom"><a href="#自定义元素托管shadow-dom" class="header-anchor">#</a> 自定义元素托管shadow DOM</h2> <h3 id="模拟微信小程序标签"><a href="#模拟微信小程序标签" class="header-anchor">#</a> 模拟微信小程序标签</h3> <p>Custom Elements API 创建的自定义元素可以像其他元素一样托管shadow DOM。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wx-text</span><span class="token punctuation">&gt;</span></span>前端南玖<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wx-text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">class</span> <span class="token class-name">wxText</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
            <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// console.log(this.innerText)</span>
                <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>innerText
                <span class="token keyword">this</span><span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token keyword">null</span>
                <span class="token keyword">const</span> shadowRoot <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'open'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                shadowRoot<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
                    &lt;span&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;
                </span><span class="token template-punctuation string">`</span></span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'wx-text'</span><span class="token punctuation">,</span> wxText<span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1da813dcf7d04530acc2c755e4c6d537~tplv-k3u1fbpfcp-watermark.image?" alt="12.png"></p> <p>上面这段代码就是模拟微信小程序的标签实现，这里为什么又跳到了小程序？因为微信小程序的实现原理跟这类似，我们知道小程序的图是在WebView里渲染的，那搭建视图的方式自然就需要用到HTML语言。然后为了管控安全，肯定不可能让开发者直接使用html来进行开发，所以就自己实现了一套组件组织框架Exparser内置在小程序基础库中。这里的Exparser框架模型上与WebComponents的ShadowDOM高度相似，但不依赖浏览器的原生支持，也没有其他依赖库。</p> <h3 id="如何查看小程序编译后的标签"><a href="#如何查看小程序编译后的标签" class="header-anchor">#</a> 如何查看小程序编译后的标签</h3> <p>很多人可能会有疑惑，我们在小程序中写的标签不是这样的呀，它们都不带有<code>wx</code>前缀。是的，为了开发者使用方便，开发时是不需要带<code>wx</code>前缀的，在编译过程会自动识别比对转换成真实DOM。</p> <ul><li>我们可以打开微信开发者工具，调试微信开发者工具，然后在控制台输入<code>document.getElementsByTagName('webview')[0].showDevTools(true,null)</code></li> <li>然后它会打开另外一个控制台，在这里就能看到类似我们上面实现的内容了</li></ul> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5b6c44da5e884b2cad0abc65e200efc6~tplv-k3u1fbpfcp-watermark.image?" alt="13.png"></p> <h2 id="推荐阅读"><a href="#推荐阅读" class="header-anchor">#</a> 推荐阅读</h2> <ul><li><a href="https://juejin.cn/post/7083744760048910366" target="_blank" rel="noopener noreferrer">性能优化之html、css、js三者的加载顺序<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/7089980191329484830" target="_blank" rel="noopener noreferrer">Vue异步更新机制以及$nextTick原理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/7075130658820980772" target="_blank" rel="noopener noreferrer">超全面总结Vue面试知识点，助力金三银四<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/7073640285904830471" target="_blank" rel="noopener noreferrer">【面试必备】前端常见的排序算法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/7077347573740077069" target="_blank" rel="noopener noreferrer">CSS性能优化的几个技巧<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/7067697624626757646" target="_blank" rel="noopener noreferrer">前端常见的安全问题及防范措施<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/7065123244881215518" target="_blank" rel="noopener noreferrer">为什么大厂前端监控都在用GIF做埋点？<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/7072174649735381029" target="_blank" rel="noopener noreferrer">前端人员不要只知道KFC，你应该了解 BFC、IFC、GFC 和 FFC<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <blockquote><p>原文首发地址<a href="https://mp.weixin.qq.com/s/Skmgv5QJzFOQqZ9wzWbkAQ" target="_blank" rel="noopener noreferrer">点这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，欢迎大家关注公众号 <strong>「前端南玖」</strong>，如果你想进前端交流群一起学习，<a href="https://juejin.cn/pin/7072217320155775007" target="_blank" rel="noopener noreferrer">请点这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p><strong>我是南玖，我们下期见！！！</strong></p></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/nanjiu/htmlcss/1.html">
          两行CSS让页面提升了近7倍渲染性能！
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/nanjiu/htmlcss/#shadow-dom-是什么" class="sidebar-link reco-side-shadow-dom-是什么" data-v-b57cc07c>shadow dom 是什么？</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#思考" class="sidebar-link reco-side-思考" data-v-b57cc07c>思考</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#查看html原生标签的shadow-dom" class="sidebar-link reco-side-查看html原生标签的shadow-dom" data-v-b57cc07c>查看html原生标签的Shadow DOM</a></li><li class="level-2" data-v-b57cc07c><a href="/nanjiu/htmlcss/#shadow-dom-结构" class="sidebar-link reco-side-shadow-dom-结构" data-v-b57cc07c>shadow dom 结构</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#shadow-host" class="sidebar-link reco-side-shadow-host" data-v-b57cc07c>shadow host</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#shadow-bounday" class="sidebar-link reco-side-shadow-bounday" data-v-b57cc07c>shadow bounday</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#shadow-tree" class="sidebar-link reco-side-shadow-tree" data-v-b57cc07c>shadow tree</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#shadow-root" class="sidebar-link reco-side-shadow-root" data-v-b57cc07c>shadow root</a></li><li class="level-2" data-v-b57cc07c><a href="/nanjiu/htmlcss/#如何使用shadow-dom" class="sidebar-link reco-side-如何使用shadow-dom" data-v-b57cc07c>如何使用shadow dom？</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#创建一个shadow-dom" class="sidebar-link reco-side-创建一个shadow-dom" data-v-b57cc07c>创建一个shadow dom</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#shadow-dom-mode" class="sidebar-link reco-side-shadow-dom-mode" data-v-b57cc07c>shadow dom mode</a></li><li class="level-2" data-v-b57cc07c><a href="/nanjiu/htmlcss/#哪些元素可以挂载shadow-dom" class="sidebar-link reco-side-哪些元素可以挂载shadow-dom" data-v-b57cc07c>哪些元素可以挂载shadow dom?</a></li><li class="level-2" data-v-b57cc07c><a href="/nanjiu/htmlcss/#shadow-dom的特点" class="sidebar-link reco-side-shadow-dom的特点" data-v-b57cc07c>shadow dom的特点</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#样式" class="sidebar-link reco-side-样式" data-v-b57cc07c>样式</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#样式化host元素" class="sidebar-link reco-side-样式化host元素" data-v-b57cc07c>样式化host元素</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#样式钩子" class="sidebar-link reco-side-样式钩子" data-v-b57cc07c>样式钩子</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#通过css访问shadow" class="sidebar-link reco-side-通过css访问shadow" data-v-b57cc07c>通过CSS访问shadow</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#事件" class="sidebar-link reco-side-事件" data-v-b57cc07c>事件</a></li><li class="level-2" data-v-b57cc07c><a href="/nanjiu/htmlcss/#自定义元素托管shadow-dom" class="sidebar-link reco-side-自定义元素托管shadow-dom" data-v-b57cc07c>自定义元素托管shadow DOM</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#模拟微信小程序标签" class="sidebar-link reco-side-模拟微信小程序标签" data-v-b57cc07c>模拟微信小程序标签</a></li><li class="level-3" data-v-b57cc07c><a href="/nanjiu/htmlcss/#如何查看小程序编译后的标签" class="sidebar-link reco-side-如何查看小程序编译后的标签" data-v-b57cc07c>如何查看小程序编译后的标签</a></li><li class="level-2" data-v-b57cc07c><a href="/nanjiu/htmlcss/#推荐阅读" class="sidebar-link reco-side-推荐阅读" data-v-b57cc07c>推荐阅读</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/nanjiu/assets/js/app.aa12a3a6.js" defer></script><script src="/nanjiu/assets/js/3.21869b4f.js" defer></script><script src="/nanjiu/assets/js/1.9b52f643.js" defer></script><script src="/nanjiu/assets/js/20.5d90702a.js" defer></script>
  </body>
</html>
